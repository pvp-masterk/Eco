<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FreshCoins - Virtual Crypto Economy</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://accounts.google.com/gsi/client" async defer></script>
    <style>
        :root {
            --primary: #6c5ce7;
            --secondary: #a29bfe;
            --dark: #2d3436;
            --light: #f5f6fa;
            --success: #00b894;
            --danger: #d63031;
            --warning: #fdcb6e;
            --info: #0984e3;
            --card-bg: #ffffff;
            --shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            --transition: all 0.3s ease;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Poppins', sans-serif;
        }

        body {
            background-color: var(--light);
            color: var(--dark);
            overflow-x: hidden;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        /* Header Styles */
        header {
            background-color: var(--primary);
            color: white;
            padding: 15px 0;
            box-shadow: var(--shadow);
            position: fixed;
            width: 100%;
            top: 0;
            z-index: 1000;
        }

        .header-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-size: 24px;
            font-weight: 700;
            display: flex;
            align-items: center;
        }

        .logo i {
            margin-right: 10px;
            color: var(--warning);
        }

        nav ul {
            display: flex;
            list-style: none;
        }

        nav ul li {
            margin-left: 30px;
            position: relative;
        }

        nav ul li a {
            color: white;
            text-decoration: none;
            font-weight: 500;
            transition: var(--transition);
            display: flex;
            align-items: center;
        }

        nav ul li a i {
            margin-right: 8px;
        }

        nav ul li a:hover {
            color: var(--warning);
        }

        .active-tab {
            color: var(--warning) !important;
            font-weight: 600;
        }

        /* Profile Dropdown */
        .profile-dropdown {
            position: relative;
            cursor: pointer;
        }

        .profile-img {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            object-fit: cover;
            border: 2px solid white;
        }

        .dropdown-menu {
            position: absolute;
            right: 0;
            top: 50px;
            background-color: var(--card-bg);
            border-radius: 8px;
            box-shadow: var(--shadow);
            width: 200px;
            opacity: 0;
            visibility: hidden;
            transition: var(--transition);
            transform: translateY(10px);
            z-index: 100;
        }

        .dropdown-menu.show {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }

        .dropdown-menu a {
            display: block;
            padding: 12px 20px;
            color: var(--dark);
            text-decoration: none;
            transition: var(--transition);
            border-bottom: 1px solid rgba(0, 0, 0, 0.05);
        }

        .dropdown-menu a:hover {
            background-color: var(--secondary);
            color: white;
        }

        .dropdown-menu a i {
            margin-right: 10px;
            width: 20px;
            text-align: center;
        }

        /* Main Content */
        main {
            margin-top: 80px;
            min-height: calc(100vh - 160px);
            padding: 30px 0;
        }

        /* Auth Page */
        .auth-container {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: calc(100vh - 160px);
        }

        .auth-card {
            background-color: var(--card-bg);
            border-radius: 15px;
            box-shadow: var(--shadow);
            padding: 40px;
            width: 100%;
            max-width: 500px;
            text-align: center;
            animation: fadeIn 0.5s ease;
        }

        .auth-card h2 {
            margin-bottom: 20px;
            color: var(--primary);
        }

        .auth-card p {
            margin-bottom: 30px;
            color: var(--dark);
        }

        .google-btn {
            background-color: white;
            color: var(--dark);
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 12px 20px;
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
            transition: var(--transition);
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 100%;
            margin-bottom: 20px;
        }

        .google-btn:hover {
            background-color: #f5f5f5;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        .google-btn i {
            font-size: 20px;
            margin-right: 10px;
            color: var(--danger);
        }

        /* Home Page */
        .section-title {
            font-size: 24px;
            margin-bottom: 20px;
            color: var(--primary);
            display: flex;
            align-items: center;
        }

        .section-title i {
            margin-right: 10px;
        }

        .coins-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }

        .coin-card {
            background-color: var(--card-bg);
            border-radius: 12px;
            padding: 20px;
            box-shadow: var(--shadow);
            transition: var(--transition);
            cursor: pointer;
            animation: fadeInUp 0.5s ease;
        }

        .coin-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }

        .coin-header {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
        }

        .coin-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            margin-right: 15px;
            object-fit: cover;
        }

        .coin-name {
            font-weight: 600;
            font-size: 18px;
        }

        .coin-symbol {
            color: var(--secondary);
            font-size: 14px;
            margin-top: 2px;
        }

        .coin-price {
            font-size: 22px;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .coin-change {
            font-size: 14px;
            font-weight: 500;
        }

        .positive {
            color: var(--success);
        }

        .negative {
            color: var(--danger);
        }

        /* Market Page */
        .market-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .create-coin-btn {
            background-color: var(--primary);
            color: white;
            border: none;
            border-radius: 8px;
            padding: 10px 20px;
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
        }

        .create-coin-btn:hover {
            background-color: #5a4bd1;
            transform: translateY(-2px);
        }

        .create-coin-btn i {
            margin-right: 8px;
        }

        .market-table {
            width: 100%;
            border-collapse: collapse;
            background-color: var(--card-bg);
            border-radius: 12px;
            overflow: hidden;
            box-shadow: var(--shadow);
            animation: fadeIn 0.5s ease;
        }

        .market-table th, .market-table td {
            padding: 15px;
            text-align: left;
        }

        .market-table th {
            background-color: var(--primary);
            color: white;
            font-weight: 500;
        }

        .market-table tr:nth-child(even) {
            background-color: rgba(108, 92, 231, 0.05);
        }

        .market-table tr:hover {
            background-color: rgba(108, 92, 231, 0.1);
        }

        .table-coin {
            display: flex;
            align-items: center;
        }

        .table-coin-icon {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            margin-right: 10px;
            object-fit: cover;
        }

        .table-actions {
            display: flex;
            gap: 10px;
        }

        .action-btn {
            padding: 6px 12px;
            border-radius: 6px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: var(--transition);
            border: none;
        }

        .buy-btn {
            background-color: var(--success);
            color: white;
        }

        .sell-btn {
            background-color: var(--danger);
            color: white;
        }

        .view-btn {
            background-color: var(--info);
            color: white;
        }

        /* Coin Detail Page */
        .coin-detail-header {
            display: flex;
            align-items: center;
            margin-bottom: 30px;
            animation: fadeIn 0.5s ease;
        }

        .detail-coin-icon {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            margin-right: 20px;
            object-fit: cover;
        }

        .detail-coin-name {
            font-size: 28px;
            font-weight: 700;
        }

        .detail-coin-symbol {
            font-size: 18px;
            color: var(--secondary);
            margin-top: 5px;
        }

        .detail-price {
            font-size: 32px;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .detail-stats {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .stat-card {
            background-color: var(--card-bg);
            border-radius: 12px;
            padding: 20px;
            box-shadow: var(--shadow);
        }

        .stat-title {
            font-size: 14px;
            color: var(--secondary);
            margin-bottom: 10px;
        }

        .stat-value {
            font-size: 24px;
            font-weight: 600;
        }

        .chart-container {
            background-color: var(--card-bg);
            border-radius: 12px;
            padding: 20px;
            box-shadow: var(--shadow);
            margin-bottom: 30px;
        }

        .coin-actions {
            display: flex;
            gap: 15px;
            margin-top: 30px;
        }

        .action-btn-lg {
            padding: 12px 24px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
            transition: var(--transition);
            border: none;
            display: flex;
            align-items: center;
        }

        .action-btn-lg i {
            margin-right: 8px;
        }

        /* Portfolio Page */
        .portfolio-stats {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .portfolio-stat-card {
            background-color: var(--card-bg);
            border-radius: 12px;
            padding: 20px;
            box-shadow: var(--shadow);
            animation: fadeInUp 0.5s ease;
        }

        .portfolio-stat-card h3 {
            font-size: 18px;
            margin-bottom: 15px;
            color: var(--primary);
        }

        .portfolio-value {
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 10px;
        }

        .portfolio-change {
            font-size: 16px;
            font-weight: 500;
        }

        .portfolio-coins {
            margin-top: 30px;
        }

        /* Profile Page */
        .profile-header {
            display: flex;
            align-items: center;
            margin-bottom: 30px;
            animation: fadeIn 0.5s ease;
        }

        .profile-avatar {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            object-fit: cover;
            margin-right: 30px;
            border: 5px solid var(--primary);
        }

        .profile-info h2 {
            font-size: 28px;
            margin-bottom: 5px;
        }

        .profile-info p {
            color: var(--secondary);
            font-size: 16px;
        }

        .profile-balance {
            font-size: 24px;
            font-weight: 700;
            color: var(--primary);
            margin-top: 10px;
        }

        .profile-stats {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .profile-stat-card {
            background-color: var(--card-bg);
            border-radius: 12px;
            padding: 20px;
            box-shadow: var(--shadow);
        }

        /* Settings Page */
        .settings-form {
            background-color: var(--card-bg);
            border-radius: 12px;
            padding: 30px;
            box-shadow: var(--shadow);
            animation: fadeIn 0.5s ease;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
        }

        .form-control {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            transition: var(--transition);
        }

        .form-control:focus {
            border-color: var(--primary);
            outline: none;
            box-shadow: 0 0 0 3px rgba(108, 92, 231, 0.2);
        }

        .save-btn {
            background-color: var(--primary);
            color: white;
            border: none;
            border-radius: 8px;
            padding: 12px 24px;
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
            transition: var(--transition);
        }

        .save-btn:hover {
            background-color: #5a4bd1;
        }

        /* Modal */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            opacity: 0;
            visibility: hidden;
            transition: var(--transition);
        }

        .modal.show {
            opacity: 1;
            visibility: visible;
        }

        .modal-content {
            background-color: var(--card-bg);
            border-radius: 12px;
            padding: 30px;
            width: 100%;
            max-width: 500px;
            box-shadow: var(--shadow);
            transform: translateY(-20px);
            transition: var(--transition);
        }

        .modal.show .modal-content {
            transform: translateY(0);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .modal-title {
            font-size: 22px;
            font-weight: 600;
            color: var(--primary);
        }

        .close-btn {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: var(--secondary);
        }

        .modal-body {
            margin-bottom: 30px;
        }

        .modal-footer {
            display: flex;
            justify-content: flex-end;
            gap: 15px;
        }

        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Footer */
        footer {
            background-color: var(--dark);
            color: white;
            padding: 30px 0;
            text-align: center;
        }

        .footer-links {
            display: flex;
            justify-content: center;
            margin-bottom: 20px;
        }

        .footer-links a {
            color: white;
            margin: 0 15px;
            text-decoration: none;
            transition: var(--transition);
        }

        .footer-links a:hover {
            color: var(--secondary);
        }

        .copyright {
            font-size: 14px;
            color: rgba(255, 255, 255, 0.7);
        }

        /* Responsive */
        @media (max-width: 768px) {
            .header-container {
                flex-direction: column;
                text-align: center;
            }

            nav ul {
                margin-top: 15px;
                flex-wrap: wrap;
                justify-content: center;
            }

            nav ul li {
                margin: 5px 15px;
            }

            .market-header {
                flex-direction: column;
                align-items: flex-start;
            }

            .create-coin-btn {
                margin-top: 15px;
            }

            .coin-detail-header {
                flex-direction: column;
                text-align: center;
            }

            .detail-coin-icon {
                margin-right: 0;
                margin-bottom: 15px;
            }

            .coin-actions {
                flex-direction: column;
            }

            .profile-header {
                flex-direction: column;
                text-align: center;
            }

            .profile-avatar {
                margin-right: 0;
                margin-bottom: 20px;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header>
        <div class="container header-container">
            <div class="logo">
                <i class="fas fa-coins"></i>
                <span>FreshCoins</span>
            </div>
            <nav>
                <ul>
                    <li><a href="#" class="active-tab" id="home-tab"><i class="fas fa-home"></i> Home</a></li>
                    <li><a href="#" id="market-tab"><i class="fas fa-chart-line"></i> Market</a></li>
                    <li><a href="#" id="portfolio-tab"><i class="fas fa-wallet"></i> Portfolio</a></li>
                    <li class="profile-dropdown" id="profile-dropdown">
                        <img src="https://via.placeholder.com/40" alt="Profile" class="profile-img" id="profile-img">
                        <div class="dropdown-menu" id="dropdown-menu">
                            <a href="#" id="profile-link"><i class="fas fa-user"></i> Profile</a>
                            <a href="#" id="settings-link"><i class="fas fa-cog"></i> Settings</a>
                            <a href="#" id="manual-link"><i class="fas fa-book"></i> User Manual</a>
                            <a href="#" id="tos-link"><i class="fas fa-file-alt"></i> Terms of Service</a>
                            <a href="#" id="privacy-link"><i class="fas fa-shield-alt"></i> Privacy Policy</a>
                            <a href="#" id="logout-link"><i class="fas fa-sign-out-alt"></i> Logout</a>
                        </div>
                    </li>
                </ul>
            </nav>
        </div>
    </header>

    <!-- Main Content -->
    <main>
        <div class="container">
            <!-- Auth Page (Shown when not logged in) -->
            <div id="auth-page" class="auth-container">
                <div class="auth-card">
                    <h2>Welcome to FreshCoins</h2>
                    <p>Sign in with your Google account to start trading virtual cryptocurrencies with FreshCoins!</p>
                    <div id="g_id_onload"
                        data-client_id="758095202640-g37d5ga22cbkq6flc8359hpejmtb2r44.apps.googleusercontent.com"
                        data-login_uri="https://eco-steel.vercel.app/auth/google"
                        data-auto_prompt="false">
                    </div>
                    <div class="g_id_signin"
                        data-type="standard"
                        data-size="large"
                        data-theme="outline"
                        data-text="sign_in_with"
                        data-shape="rectangular"
                        data-logo_alignment="left">
                    </div>
                    <p class="small-text">By signing in, you agree to our <a href="#">Terms of Service</a> and <a href="#">Privacy Policy</a>.</p>
                </div>
            </div>

            <!-- Home Page -->
            <div id="home-page" style="display: none;">
                <h1 class="section-title"><i class="fas fa-fire"></i> Trending Cryptos</h1>
                <div class="coins-grid" id="trending-coins">
                    <!-- Trending coins will be loaded here -->
                </div>

                <h1 class="section-title"><i class="fas fa-star"></i> Popular Cryptos</h1>
                <div class="coins-grid" id="popular-coins">
                    <!-- Popular coins will be loaded here -->
                </div>

                <h1 class="section-title"><i class="fas fa-clock"></i> Recently Added</h1>
                <div class="coins-grid" id="recent-coins">
                    <!-- Recent coins will be loaded here -->
                </div>
            </div>

            <!-- Market Page -->
            <div id="market-page" style="display: none;">
                <div class="market-header">
                    <h1 class="section-title"><i class="fas fa-chart-line"></i> Crypto Market</h1>
                    <button class="create-coin-btn" id="create-coin-btn"><i class="fas fa-plus"></i> Create New Coin (2000 FC)</button>
                </div>
                <table class="market-table">
                    <thead>
                        <tr>
                            <th>#</th>
                            <th>Name</th>
                            <th>Price (FC)</th>
                            <th>24h Change</th>
                            <th>Market Cap (FC)</th>
                            <th>Volume (FC)</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="market-table-body">
                        <!-- Market data will be loaded here -->
                    </tbody>
                </table>
            </div>

            <!-- Coin Detail Page -->
            <div id="coin-detail-page" style="display: none;">
                <div class="coin-detail-header">
                    <img src="https://via.placeholder.com/60" alt="Coin" class="detail-coin-icon" id="detail-coin-icon">
                    <div>
                        <h1 class="detail-coin-name" id="detail-coin-name">Bitcoin <span class="detail-coin-symbol" id="detail-coin-symbol">(BTC)</span></h1>
                        <h2 class="detail-price" id="detail-price">10,000 FC</h2>
                        <span class="coin-change positive" id="detail-change">+5.23%</span>
                    </div>
                </div>

                <div class="detail-stats">
                    <div class="stat-card">
                        <div class="stat-title">Market Cap</div>
                        <div class="stat-value" id="detail-market-cap">1,000,000 FC</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-title">Volume (24h)</div>
                        <div class="stat-value" id="detail-volume">50,000 FC</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-title">Circulating Supply</div>
                        <div class="stat-value" id="detail-supply">100 BTC</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-title">Your Holdings</div>
                        <div class="stat-value" id="detail-holdings">0 BTC (0 FC)</div>
                    </div>
                </div>

                <div class="chart-container">
                    <canvas id="coin-chart"></canvas>
                </div>

                <div class="coin-actions">
                    <button class="action-btn-lg buy-btn" id="detail-buy-btn"><i class="fas fa-shopping-cart"></i> Buy</button>
                    <button class="action-btn-lg sell-btn" id="detail-sell-btn"><i class="fas fa-money-bill-wave"></i> Sell</button>
                </div>
            </div>

            <!-- Portfolio Page -->
            <div id="portfolio-page" style="display: none;">
                <h1 class="section-title"><i class="fas fa-wallet"></i> My Portfolio</h1>
                
                <div class="portfolio-stats">
                    <div class="portfolio-stat-card">
                        <h3>Total Value</h3>
                        <div class="portfolio-value" id="portfolio-total-value">25,000 FC</div>
                        <div class="portfolio-change positive">+12.5%</div>
                    </div>
                    <div class="portfolio-stat-card">
                        <h3>Available FreshCoins</h3>
                        <div class="portfolio-value" id="portfolio-balance">10,000 FC</div>
                        <div class="portfolio-change">Ready to trade</div>
                    </div>
                    <div class="portfolio-stat-card">
                        <h3>Profit/Loss (All Time)</h3>
                        <div class="portfolio-value" id="portfolio-profit">+5,000 FC</div>
                        <div class="portfolio-change positive">+25%</div>
                    </div>
                </div>

                <h2 class="section-title"><i class="fas fa-coins"></i> My Coins</h2>
                <table class="market-table">
                    <thead>
                        <tr>
                            <th>#</th>
                            <th>Name</th>
                            <th>Amount</th>
                            <th>Value (FC)</th>
                            <th>Avg Buy Price</th>
                            <th>Profit/Loss</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="portfolio-table-body">
                        <!-- Portfolio data will be loaded here -->
                    </tbody>
                </table>

                <h2 class="section-title"><i class="fas fa-plus-circle"></i> My Created Coins</h2>
                <table class="market-table">
                    <thead>
                        <tr>
                            <th>#</th>
                            <th>Name</th>
                            <th>Current Price</th>
                            <th>Market Cap</th>
                            <th>Total Supply</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="created-coins-table-body">
                        <!-- Created coins data will be loaded here -->
                    </tbody>
                </table>
            </div>

            <!-- Profile Page -->
            <div id="profile-page" style="display: none;">
                <div class="profile-header">
                    <img src="https://via.placeholder.com/100" alt="Profile" class="profile-avatar" id="profile-avatar">
                    <div class="profile-info">
                        <h2 id="profile-name">John Doe</h2>
                        <p id="profile-username">@johndoe</p>
                        <div class="profile-balance" id="profile-balance">25,000 FC</div>
                    </div>
                </div>

                <div class="profile-stats">
                    <div class="profile-stat-card">
                        <div class="stat-title">Total Trades</div>
                        <div class="stat-value" id="total-trades">142</div>
                    </div>
                    <div class="profile-stat-card">
                        <div class="stat-title">Coins Owned</div>
                        <div class="stat-value" id="coins-owned">8</div>
                    </div>
                    <div class="profile-stat-card">
                        <div class="stat-title">Coins Created</div>
                        <div class="stat-value" id="coins-created">3</div>
                    </div>
                    <div class="profile-stat-card">
                        <div class="stat-title">Member Since</div>
                        <div class="stat-value" id="member-since">Jan 2023</div>
                    </div>
                </div>

                <h2 class="section-title"><i class="fas fa-history"></i> Recent Activity</h2>
                <table class="market-table">
                    <thead>
                        <tr>
                            <th>Date</th>
                            <th>Type</th>
                            <th>Coin</th>
                            <th>Amount</th>
                            <th>Price (FC)</th>
                            <th>Total (FC)</th>
                        </tr>
                    </thead>
                    <tbody id="activity-table-body">
                        <!-- Activity data will be loaded here -->
                    </tbody>
                </table>
            </div>

            <!-- Settings Page -->
            <div id="settings-page" style="display: none;">
                <h1 class="section-title"><i class="fas fa-cog"></i> Account Settings</h1>
                
                <div class="settings-form">
                    <div class="form-group">
                        <label for="display-name">Display Name</label>
                        <input type="text" id="display-name" class="form-control" placeholder="Enter your display name">
                    </div>
                    <div class="form-group">
                        <label for="username">Username</label>
                        <input type="text" id="username" class="form-control" placeholder="Enter your username">
                        <small class="text-muted">This must be unique and cannot be changed later</small>
                    </div>
                    <div class="form-group">
                        <label for="profile-pic">Profile Picture URL</label>
                        <input type="text" id="profile-pic" class="form-control" placeholder="Enter URL for your profile picture">
                    </div>
                    <button class="save-btn" id="save-settings-btn">Save Changes</button>
                </div>
            </div>

            <!-- User Manual Page -->
            <div id="manual-page" style="display: none;">
                <h1 class="section-title"><i class="fas fa-book"></i> User Manual</h1>
                
                <div class="settings-form">
                    <h2>Welcome to FreshCoins!</h2>
                    <p>FreshCoins is a virtual cryptocurrency trading platform where you can buy, sell, and even create your own cryptocurrencies using our virtual currency, FreshCoins (FC).</p>
                    
                    <h3>Getting Started</h3>
                    <p>1. Sign in with your Google account to get 10,000 FC as a starting balance.</p>
                    <p>2. Browse the market to see available cryptocurrencies.</p>
                    <p>3. Click on any coin to view detailed information and trading options.</p>
                    
                    <h3>Buying and Selling</h3>
                    <p>To buy a cryptocurrency:</p>
                    <ol>
                        <li>Navigate to the coin's page</li>
                        <li>Click the "Buy" button</li>
                        <li>Enter the amount you want to buy</li>
                        <li>Confirm the transaction</li>
                    </ol>
                    
                    <p>Selling works the same way, just click the "Sell" button instead.</p>
                    
                    <h3>Creating Your Own Coin</h3>
                    <p>For 2,000 FC, you can create your own cryptocurrency:</p>
                    <ol>
                        <li>Click "Create New Coin" on the Market page</li>
                        <li>Upload an image for your coin</li>
                        <li>Give it a name and symbol (like BTC for Bitcoin)</li>
                        <li>Set the initial supply and price</li>
                        <li>Pay the creation fee and launch your coin!</li>
                    </ol>
                    
                    <h3>Tracking Your Portfolio</h3>
                    <p>The Portfolio page shows:</p>
                    <ul>
                        <li>Your current balance in FC</li>
                        <li>All the cryptocurrencies you own</li>
                        <li>Your profit/loss for each coin</li>
                        <li>Coins you've created</li>
                    </ul>
                    
                    <h3>Need Help?</h3>
                    <p>If you have any questions, please contact us at support@freshcoins.com</p>
                </div>
            </div>

            <!-- Terms of Service Page -->
            <div id="tos-page" style="display: none;">
                <h1 class="section-title"><i class="fas fa-file-alt"></i> Terms of Service</h1>
                
                <div class="settings-form">
                    <h2>FreshCoins Terms of Service</h2>
                    <p><strong>Last Updated: January 1, 2023</strong></p>
                    
                    <h3>1. Acceptance of Terms</h3>
                    <p>By accessing or using the FreshCoins website ("Service"), you agree to be bound by these Terms of Service ("Terms"). If you disagree with any part of the terms, you may not access the Service.</p>
                    
                    <h3>2. Description of Service</h3>
                    <p>FreshCoins is a virtual cryptocurrency trading platform that allows users to simulate buying, selling, and creating cryptocurrencies using a virtual currency called FreshCoins (FC). This is not real money and has no monetary value.</p>
                    
                    <h3>3. User Accounts</h3>
                    <p>You must create an account using your Google account to use the Service. You are responsible for maintaining the confidentiality of your account and password.</p>
                    
                    <h3>4. Virtual Currency</h3>
                    <p>FreshCoins (FC) are virtual tokens that exist solely within the Service. They are not real currency, cannot be exchanged for real money, and have no monetary value.</p>
                    
                    <h3>5. User Conduct</h3>
                    <p>You agree not to:</p>
                    <ul>
                        <li>Use the Service for any illegal purpose</li>
                        <li>Create multiple accounts to gain an unfair advantage</li>
                        <li>Attempt to hack or manipulate the Service</li>
                        <li>Create offensive or inappropriate coin names or images</li>
                    </ul>
                    
                    <h3>6. Termination</h3>
                    <p>We may terminate or suspend your account immediately, without prior notice or liability, for any reason whatsoever, including without limitation if you breach the Terms.</p>
                    
                    <h3>7. Changes to Terms</h3>
                    <p>We reserve the right to modify these Terms at any time. Your continued use of the Service after any such changes constitutes your acceptance of the new Terms.</p>
                    
                    <h3>8. Contact Us</h3>
                    <p>If you have any questions about these Terms, please contact us at legal@freshcoins.com</p>
                </div>
            </div>

            <!-- Privacy Policy Page -->
            <div id="privacy-page" style="display: none;">
                <h1 class="section-title"><i class="fas fa-shield-alt"></i> Privacy Policy</h1>
                
                <div class="settings-form">
                    <h2>FreshCoins Privacy Policy</h2>
                    <p><strong>Last Updated: January 1, 2023</strong></p>
                    
                    <h3>1. Information We Collect</h3>
                    <p>When you sign in with Google, we collect:</p>
                    <ul>
                        <li>Your name</li>
                        <li>Email address</li>
                        <li>Profile picture URL</li>
                    </ul>
                    <p>We also collect data about your activity on FreshCoins, including:</p>
                    <ul>
                        <li>Transactions you make</li>
                        <li>Coins you create</li>
                        <li>Your portfolio information</li>
                    </ul>
                    
                    <h3>2. How We Use Your Information</h3>
                    <p>We use the information we collect to:</p>
                    <ul>
                        <li>Provide and maintain the Service</li>
                        <li>Personalize your experience</li>
                        <li>Improve the Service</li>
                        <li>Monitor usage of the Service</li>
                        <li>Detect and prevent abuse</li>
                    </ul>
                    
                    <h3>3. Data Security</h3>
                    <p>We implement security measures to protect your data, but no method of transmission over the Internet is 100% secure.</p>
                    
                    <h3>4. Children's Privacy</h3>
                    <p>Our Service is not intended for children under 13. We do not knowingly collect personal information from children under 13.</p>
                    
                    <h3>5. Changes to This Policy</h3>
                    <p>We may update our Privacy Policy from time to time. We will notify you of any changes by posting the new Privacy Policy on this page.</p>
                    
                    <h3>6. Contact Us</h3>
                    <p>If you have any questions about this Privacy Policy, please contact us at privacy@freshcoins.com</p>
                </div>
            </div>
        </div>
    </main>

    <!-- Create Coin Modal -->
    <div class="modal" id="create-coin-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Create New Coin</h3>
                <button class="close-btn" id="close-create-coin-modal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="coin-name">Coin Name</label>
                    <input type="text" id="coin-name" class="form-control" placeholder="e.g. Bitcoin">
                </div>
                <div class="form-group">
                    <label for="coin-symbol">Coin Symbol</label>
                    <input type="text" id="coin-symbol" class="form-control" placeholder="e.g. BTC (3-5 characters)">
                    <small class="text-muted">This will be used in coin URLs (FreshCoins/coins/BTC)</small>
                </div>
                <div class="form-group">
                    <label for="coin-image">Coin Image URL</label>
                    <input type="text" id="coin-image" class="form-control" placeholder="Paste image URL here">
                </div>
                <div class="form-group">
                    <label for="initial-price">Initial Price (FC)</label>
                    <input type="number" id="initial-price" class="form-control" placeholder="e.g. 100" value="100">
                </div>
                <div class="form-group">
                    <label for="total-supply">Total Supply</label>
                    <input type="number" id="total-supply" class="form-control" placeholder="e.g. 1000000" value="1000000">
                </div>
                <p>Creation fee: <strong>2,000 FC</strong></p>
            </div>
            <div class="modal-footer">
                <button class="action-btn" id="cancel-create-coin">Cancel</button>
                <button class="action-btn buy-btn" id="confirm-create-coin">Create Coin</button>
            </div>
        </div>
    </div>

    <!-- Buy/Sell Modal -->
    <div class="modal" id="trade-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title" id="trade-modal-title">Buy Bitcoin (BTC)</h3>
                <button class="close-btn" id="close-trade-modal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="trade-amount">Amount</label>
                    <input type="number" id="trade-amount" class="form-control" placeholder="Enter amount">
                </div>
                <div class="form-group">
                    <label for="trade-price">Price per coin (FC)</label>
                    <input type="number" id="trade-price" class="form-control" readonly>
                </div>
                <div class="form-group">
                    <label for="trade-total">Total Cost (FC)</label>
                    <input type="number" id="trade-total" class="form-control" readonly>
                </div>
                <div id="trade-balance-info">Your balance: <span id="trade-balance">10,000</span> FC</div>
            </div>
            <div class="modal-footer">
                <button class="action-btn" id="cancel-trade">Cancel</button>
                <button class="action-btn buy-btn" id="confirm-trade">Confirm</button>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer>
        <div class="container">
            <div class="footer-links">
                <a href="#" id="footer-home">Home</a>
                <a href="#" id="footer-market">Market</a>
                <a href="#" id="footer-portfolio">Portfolio</a>
                <a href="#" id="footer-tos">Terms</a>
                <a href="#" id="footer-privacy">Privacy</a>
                <a href="#" id="footer-contact">Contact</a>
            </div>
            <div class="copyright">
                &copy; 2023 FreshCoins. All rights reserved. This is a virtual economy simulation, not real money.
            </div>
        </div>
    </footer>

    <script>
        // Global variables
        let currentUser = null;
        let coins = [];
        let transactions = [];
        let priceHistory = {};
        let currentView = 'auth';
        let currentCoinView = null;
        
        // DOM Elements
        const authPage = document.getElementById('auth-page');
        const homePage = document.getElementById('home-page');
        const marketPage = document.getElementById('market-page');
        const coinDetailPage = document.getElementById('coin-detail-page');
        const portfolioPage = document.getElementById('portfolio-page');
        const profilePage = document.getElementById('profile-page');
        const settingsPage = document.getElementById('settings-page');
        const manualPage = document.getElementById('manual-page');
        const tosPage = document.getElementById('tos-page');
        const privacyPage = document.getElementById('privacy-page');
        
        // Navigation tabs
        const homeTab = document.getElementById('home-tab');
        const marketTab = document.getElementById('market-tab');
        const portfolioTab = document.getElementById('portfolio-tab');
        
        // Profile dropdown
        const profileDropdown = document.getElementById('profile-dropdown');
        const dropdownMenu = document.getElementById('dropdown-menu');
        const profileLink = document.getElementById('profile-link');
        const settingsLink = document.getElementById('settings-link');
        const manualLink = document.getElementById('manual-link');
        const tosLink = document.getElementById('tos-link');
        const privacyLink = document.getElementById('privacy-link');
        const logoutLink = document.getElementById('logout-link');
        
        // Modals
        const createCoinModal = document.getElementById('create-coin-modal');
        const closeCreateCoinModal = document.getElementById('close-create-coin-modal');
        const cancelCreateCoin = document.getElementById('cancel-create-coin');
        const confirmCreateCoin = document.getElementById('confirm-create-coin');
        
        const tradeModal = document.getElementById('trade-modal');
        const closeTradeModal = document.getElementById('close-trade-modal');
        const cancelTrade = document.getElementById('cancel-trade');
        const confirmTrade = document.getElementById('confirm-trade');
        const tradeModalTitle = document.getElementById('trade-modal-title');
        const tradeAmount = document.getElementById('trade-amount');
        const tradePrice = document.getElementById('trade-price');
        const tradeTotal = document.getElementById('trade-total');
        const tradeBalance = document.getElementById('trade-balance');
        
        // Initialize the app
        function init() {
            // Load sample data if no data in localStorage
            if (!localStorage.getItem('freshcoinsData')) {
                loadSampleData();
            } else {
                loadData();
            }
            
            // Check if user is logged in
            if (localStorage.getItem('freshcoinsUser')) {
                currentUser = JSON.parse(localStorage.getItem('freshcoinsUser'));
                showPage('home');
                updateUI();
            } else {
                showPage('auth');
            }
            
            // Setup event listeners
            setupEventListeners();
        }
        
        // Load sample data
        function loadSampleData() {
            coins = [
                {
                    id: 'bitcoin',
                    name: 'Bitcoin',
                    symbol: 'BTC',
                    image: 'https://cryptologos.cc/logos/bitcoin-btc-logo.png',
                    currentPrice: 10000,
                    marketCap: 190000000,
                    totalSupply: 21000000,
                    circulatingSupply: 19000000,
                    change24h: 5.23,
                    volume24h: 50000000,
                    creator: null,
                    createdAt: new Date().getTime() - 86400000 * 7
                },
                {
                    id: 'ethereum',
                    name: 'Ethereum',
                    symbol: 'ETH',
                    image: 'https://cryptologos.cc/logos/ethereum-eth-logo.png',
                    currentPrice: 800,
                    marketCap: 96000000,
                    totalSupply: null,
                    circulatingSupply: 120000000,
                    change24h: -2.15,
                    volume24h: 30000000,
                    creator: null,
                    createdAt: new Date().getTime() - 86400000 * 5
                },
                {
                    id: 'freshcoin',
                    name: 'FreshCoin',
                    symbol: 'FC',
                    image: 'https://via.placeholder.com/60',
                    currentPrice: 1,
                    marketCap: 1000000000,
                    totalSupply: 1000000000,
                    circulatingSupply: 500000000,
                    change24h: 0,
                    volume24h: 1000000,
                    creator: null,
                    createdAt: new Date().getTime() - 86400000 * 30
                }
            ];
            
            // Generate price history for each coin
            coins.forEach(coin => {
                priceHistory[coin.id] = generatePriceHistory(coin.currentPrice, 30);
            });
            
            // Save to localStorage
            saveData();
        }
        
        // Generate random price history
        function generatePriceHistory(currentPrice, days) {
            const history = [];
            let price = currentPrice;
            
            for (let i = days; i >= 0; i--) {
                const date = new Date();
                date.setDate(date.getDate() - i);
                
                // Random price change (-5% to +5%)
                const change = (Math.random() * 0.1) - 0.05;
                price = price * (1 + change);
                
                history.push({
                    date: date.getTime(),
                    price: parseFloat(price.toFixed(2))
                });
            }
            
            return history;
        }
        
        // Load data from localStorage
        function loadData() {
            const data = JSON.parse(localStorage.getItem('freshcoinsData'));
            coins = data.coins || [];
            priceHistory = data.priceHistory || {};
            transactions = data.transactions || [];
        }
        
        // Save data to localStorage
        function saveData() {
            const data = {
                coins,
                priceHistory,
                transactions
            };
            localStorage.setItem('freshcoinsData', JSON.stringify(data));
            
            if (currentUser) {
                localStorage.setItem('freshcoinsUser', JSON.stringify(currentUser));
            }
        }
        
        // Setup event listeners
        function setupEventListeners() {
            // Navigation tabs
            homeTab.addEventListener('click', () => showPage('home'));
            marketTab.addEventListener('click', () => showPage('market'));
            portfolioTab.addEventListener('click', () => showPage('portfolio'));
            
            // Profile dropdown
            profileDropdown.addEventListener('click', toggleDropdown);
            profileLink.addEventListener('click', () => showPage('profile'));
            settingsLink.addEventListener('click', () => showPage('settings'));
            manualLink.addEventListener('click', () => showPage('manual'));
            tosLink.addEventListener('click', () => showPage('tos'));
            privacyLink.addEventListener('click', () => showPage('privacy'));
            logoutLink.addEventListener('click', logout);
            
            // Footer links
            document.getElementById('footer-home').addEventListener('click', () => showPage('home'));
            document.getElementById('footer-market').addEventListener('click', () => showPage('market'));
            document.getElementById('footer-portfolio').addEventListener('click', () => showPage('portfolio'));
            document.getElementById('footer-tos').addEventListener('click', () => showPage('tos'));
            document.getElementById('footer-privacy').addEventListener('click', () => showPage('privacy'));
            
            // Create coin modal
            document.getElementById('create-coin-btn').addEventListener('click', () => {
                if (currentUser.balance >= 2000) {
                    createCoinModal.classList.add('show');
                } else {
                    alert('You need at least 2,000 FC to create a new coin!');
                }
            });
            
            closeCreateCoinModal.addEventListener('click', () => createCoinModal.classList.remove('show'));
            cancelCreateCoin.addEventListener('click', () => createCoinModal.classList.remove('show'));
            
            confirmCreateCoin.addEventListener('click', () => {
                const name = document.getElementById('coin-name').value;
                const symbol = document.getElementById('coin-symbol').value.toUpperCase();
                const image = document.getElementById('coin-image').value;
                const initialPrice = parseFloat(document.getElementById('initial-price').value);
                const totalSupply = parseInt(document.getElementById('total-supply').value);
                
                if (!name || !symbol || !image) {
                    alert('Please fill in all fields!');
                    return;
                }
                
                if (symbol.length < 2 || symbol.length > 5) {
                    alert('Symbol must be between 2-5 characters!');
                    return;
                }
                
                // Check if symbol is already taken
                if (coins.some(coin => coin.symbol === symbol)) {
                    alert('A coin with this symbol already exists!');
                    return;
                }
                
                // Create new coin
                const newCoin = {
                    id: symbol.toLowerCase(),
                    name,
                    symbol,
                    image,
                    currentPrice: initialPrice,
                    marketCap: initialPrice * totalSupply,
                    totalSupply,
                    circulatingSupply: totalSupply,
                    change24h: 0,
                    volume24h: 0,
                    creator: currentUser.id,
                    createdAt: new Date().getTime()
                };
                
                coins.push(newCoin);
                priceHistory[newCoin.id] = generatePriceHistory(initialPrice, 30);
                
                // Deduct creation fee
                currentUser.balance -= 2000;
                
                // Add transaction
                transactions.push({
                    id: generateId(),
                    userId: currentUser.id,
                    type: 'coin_creation',
                    coinId: newCoin.id,
                    amount: 2000,
                    timestamp: new Date().getTime(),
                    details: `Created ${name} (${symbol})`
                });
                
                // Save data
                saveData();
                
                // Reset form and close modal
                document.getElementById('coin-name').value = '';
                document.getElementById('coin-symbol').value = '';
                document.getElementById('coin-image').value = '';
                document.getElementById('initial-price').value = '100';
                document.getElementById('total-supply').value = '1000000';
                
                createCoinModal.classList.remove('show');
                
                // Update UI
                updateUI();
                showPage('market');
            });
            
            // Trade modal
            closeTradeModal.addEventListener('click', () => tradeModal.classList.remove('show'));
            cancelTrade.addEventListener('click', () => tradeModal.classList.remove('show'));
            
            tradeAmount.addEventListener('input', updateTradeTotal);
            
            // Buy/Sell buttons in coin detail
            document.getElementById('detail-buy-btn').addEventListener('click', () => {
                openTradeModal(currentCoinView, 'buy');
            });
            
            document.getElementById('detail-sell-btn').addEventListener('click', () => {
                openTradeModal(currentCoinView, 'sell');
            });
            
            confirmTrade.addEventListener('click', executeTrade);
            
            // Settings form
            document.getElementById('save-settings-btn').addEventListener('click', saveSettings);
            
            // Handle Google Sign-In
            window.handleCredentialResponse = (response) => {
                // Decode the JWT token to get user info
                const payload = JSON.parse(atob(response.credential.split('.')[1]));
                
                // Create or load user
                let user = JSON.parse(localStorage.getItem('freshcoinsUser')) || {
                    id: payload.sub,
                    name: payload.name,
                    username: generateUsername(payload.name),
                    email: payload.email,
                    picture: payload.picture,
                    balance: 10000, // Starting balance
                    createdAt: new Date().getTime(),
                    displayName: payload.name,
                    coins: {},
                    createdCoins: []
                };
                
                // Update user data
                user.name = payload.name;
                user.email = payload.email;
                user.picture = payload.picture;
                
                // Set as current user
                currentUser = user;
                localStorage.setItem('freshcoinsUser', JSON.stringify(user));
                
                // Show home page
                showPage('home');
                updateUI();
            };
        }
        
        // Toggle profile dropdown
        function toggleDropdown() {
            dropdownMenu.classList.toggle('show');
        }
        
        // Close dropdown when clicking outside
        document.addEventListener('click', (e) => {
            if (!profileDropdown.contains(e.target)) {
                dropdownMenu.classList.remove('show');
            }
        });
        
        // Show a specific page
        function showPage(page) {
            // Hide all pages
            authPage.style.display = 'none';
            homePage.style.display = 'none';
            marketPage.style.display = 'none';
            coinDetailPage.style.display = 'none';
            portfolioPage.style.display = 'none';
            profilePage.style.display = 'none';
            settingsPage.style.display = 'none';
            manualPage.style.display = 'none';
            tosPage.style.display = 'none';
            privacyPage.style.display = 'none';
            
            // Reset active tab
            homeTab.classList.remove('active-tab');
            marketTab.classList.remove('active-tab');
            portfolioTab.classList.remove('active-tab');
            
            // Show the requested page
            currentView = page;
            
            switch (page) {
                case 'auth':
                    authPage.style.display = 'flex';
                    break;
                case 'home':
                    homePage.style.display = 'block';
                    homeTab.classList.add('active-tab');
                    renderHomePage();
                    break;
                case 'market':
                    marketPage.style.display = 'block';
                    marketTab.classList.add('active-tab');
                    renderMarketPage();
                    break;
                case 'coin':
                    coinDetailPage.style.display = 'block';
                    renderCoinDetailPage();
                    break;
                case 'portfolio':
                    portfolioPage.style.display = 'block';
                    portfolioTab.classList.add('active-tab');
                    renderPortfolioPage();
                    break;
                case 'profile':
                    profilePage.style.display = 'block';
                    renderProfilePage();
                    break;
                case 'settings':
                    settingsPage.style.display = 'block';
                    renderSettingsPage();
                    break;
                case 'manual':
                    manualPage.style.display = 'block';
                    break;
                case 'tos':
                    tosPage.style.display = 'block';
                    break;
                case 'privacy':
                    privacyPage.style.display = 'block';
                    break;
            }
        }
        
        // Render home page
        function renderHomePage() {
            // Sort coins by different criteria
            const trendingCoins = [...coins]
                .sort((a, b) => Math.abs(b.change24h) - Math.abs(a.change24h))
                .slice(0, 6);
            
            const popularCoins = [...coins]
                .sort((a, b) => b.marketCap - a.marketCap)
                .slice(0, 6);
            
            const recentCoins = [...coins]
                .sort((a, b) => b.createdAt - a.createdAt)
                .slice(0, 6);
            
            // Render trending coins
            const trendingContainer = document.getElementById('trending-coins');
            trendingContainer.innerHTML = '';
            
            trendingCoins.forEach(coin => {
                trendingContainer.appendChild(createCoinCard(coin));
            });
            
            // Render popular coins
            const popularContainer = document.getElementById('popular-coins');
            popularContainer.innerHTML = '';
            
            popularCoins.forEach(coin => {
                popularContainer.appendChild(createCoinCard(coin));
            });
            
            // Render recent coins
            const recentContainer = document.getElementById('recent-coins');
            recentContainer.innerHTML = '';
            
            recentCoins.forEach(coin => {
                recentContainer.appendChild(createCoinCard(coin));
            });
        }
        
        // Create a coin card element
        function createCoinCard(coin) {
            const card = document.createElement('div');
            card.className = 'coin-card';
            card.addEventListener('click', () => {
                currentCoinView = coin.id;
                showPage('coin');
            });
            
            const changeClass = coin.change24h >= 0 ? 'positive' : 'negative';
            const changeIcon = coin.change24h >= 0 ? 'fa-arrow-up' : 'fa-arrow-down';
            
            card.innerHTML = `
                <div class="coin-header">
                    <img src="${coin.image}" alt="${coin.name}" class="coin-icon">
                    <div>
                        <div class="coin-name">${coin.name}</div>
                        <div class="coin-symbol">${coin.symbol}</div>
                    </div>
                </div>
                <div class="coin-price">${formatCurrency(coin.currentPrice)} FC</div>
                <div class="coin-change ${changeClass}">
                    <i class="fas ${changeIcon}"></i> ${Math.abs(coin.change24h).toFixed(2)}%
                </div>
            `;
            
            return card;
        }
        
        // Render market page
        function renderMarketPage() {
            const tableBody = document.getElementById('market-table-body');
            tableBody.innerHTML = '';
            
            coins.forEach((coin, index) => {
                const row = document.createElement('tr');
                
                const changeClass = coin.change24h >= 0 ? 'positive' : 'negative';
                const changeIcon = coin.change24h >= 0 ? 'fa-arrow-up' : 'fa-arrow-down';
                
                row.innerHTML = `
                    <td>${index + 1}</td>
                    <td>
                        <div class="table-coin">
                            <img src="${coin.image}" alt="${coin.name}" class="table-coin-icon">
                            <div>
                                <div>${coin.name}</div>
                                <div class="coin-symbol">${coin.symbol}</div>
                            </div>
                        </div>
                    </td>
                    <td>${formatCurrency(coin.currentPrice)}</td>
                    <td class="${changeClass}">
                        <i class="fas ${changeIcon}"></i> ${Math.abs(coin.change24h).toFixed(2)}%
                    </td>
                    <td>${formatCurrency(coin.marketCap)}</td>
                    <td>${formatCurrency(coin.volume24h)}</td>
                    <td>
                        <div class="table-actions">
                            <button class="action-btn view-btn" data-coin="${coin.id}">View</button>
                        </div>
                    </td>
                `;
                
                tableBody.appendChild(row);
            });
            
            // Add event listeners to view buttons
            document.querySelectorAll('.view-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    e.stopPropagation();
                    currentCoinView = btn.getAttribute('data-coin');
                    showPage('coin');
                });
            });
            
            // Make rows clickable
            document.querySelectorAll('#market-table-body tr').forEach(row => {
                row.addEventListener('click', () => {
                    const index = row.cells[0].textContent - 1;
                    currentCoinView = coins[index].id;
                    showPage('coin');
                });
            });
        }
        
        // Render coin detail page
        function renderCoinDetailPage() {
            const coin = coins.find(c => c.id === currentCoinView);
            if (!coin) {
                showPage('market');
                return;
            }
            
            // Update basic info
            document.getElementById('detail-coin-icon').src = coin.image;
            document.getElementById('detail-coin-name').textContent = coin.name;
            document.getElementById('detail-coin-symbol').textContent = `(${coin.symbol})`;
            document.getElementById('detail-price').textContent = `${formatCurrency(coin.currentPrice)} FC`;
            
            const changeElement = document.getElementById('detail-change');
            changeElement.textContent = `${coin.change24h >= 0 ? '+' : ''}${coin.change24h.toFixed(2)}%`;
            changeElement.className = `coin-change ${coin.change24h >= 0 ? 'positive' : 'negative'}`;
            
            // Update stats
            document.getElementById('detail-market-cap').textContent = `${formatCurrency(coin.marketCap)} FC`;
            document.getElementById('detail-volume').textContent = `${formatCurrency(coin.volume24h)} FC`;
            document.getElementById('detail-supply').textContent = coin.circulatingSupply ? 
                `${formatCurrency(coin.circulatingSupply)} ${coin.symbol}` : 'N/A';
            
            // Update holdings
            const holdings = currentUser.coins[coin.id] || 0;
            const holdingsValue = holdings * coin.currentPrice;
            document.getElementById('detail-holdings').textContent = 
                `${formatCurrency(holdings)} ${coin.symbol} (${formatCurrency(holdingsValue)} FC)`;
            
            // Render chart
            renderCoinChart(coin);
            
            // Update buy/sell buttons
            document.getElementById('detail-buy-btn').textContent = `Buy ${coin.symbol}`;
            document.getElementById('detail-sell-btn').textContent = `Sell ${coin.symbol}`;
        }
        
        // Render coin chart
        function renderCoinChart(coin) {
            const ctx = document.getElementById('coin-chart').getContext('2d');
            
            // Get price history (last 30 days)
            const history = priceHistory[coin.id] || [];
            const labels = history.map(item => {
                const date = new Date(item.date);
                return date.toLocaleDateString();
            });
            
            const data = history.map(item => item.price);
            
            // Destroy previous chart if exists
            if (window.coinChart) {
                window.coinChart.destroy();
            }
            
            window.coinChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [{
                        label: `${coin.name} Price (FC)`,
                        data: data,
                        borderColor: '#6c5ce7',
                        backgroundColor: 'rgba(108, 92, 231, 0.1)',
                        borderWidth: 2,
                        fill: true,
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: 'top',
                        },
                        tooltip: {
                            mode: 'index',
                            intersect: false,
                        }
                    },
                    scales: {
                        x: {
                            grid: {
                                display: false
                            }
                        },
                        y: {
                            beginAtZero: false,
                            grid: {
                                color: 'rgba(0, 0, 0, 0.05)'
                            }
                        }
                    }
                }
            });
        }
        
        // Render portfolio page
        function renderPortfolioPage() {
            // Calculate portfolio value
            let totalValue = currentUser.balance;
            let profitLoss = 0;
            let ownedCoins = [];
            
            // Calculate value of each owned coin
            for (const coinId in currentUser.coins) {
                const coin = coins.find(c => c.id === coinId);
                if (coin) {
                    const amount = currentUser.coins[coinId];
                    const value = amount * coin.currentPrice;
                    totalValue += value;
                    
                    // Calculate average buy price (simplified)
                    const avgBuyPrice = coin.currentPrice * 0.9; // Just for demo
                    const pl = (coin.currentPrice - avgBuyPrice) * amount;
                    profitLoss += pl;
                    
                    ownedCoins.push({
                        coin,
                        amount,
                        value,
                        avgBuyPrice,
                        profitLoss: pl,
                        profitLossPct: ((coin.currentPrice / avgBuyPrice) - 1) * 100
                    });
                }
            }
            
            // Update portfolio stats
            document.getElementById('portfolio-total-value').textContent = `${formatCurrency(totalValue)} FC`;
            document.getElementById('portfolio-balance').textContent = `${formatCurrency(currentUser.balance)} FC`;
            
            const profitElement = document.getElementById('portfolio-profit');
            profitElement.textContent = `${profitLoss >= 0 ? '+' : ''}${formatCurrency(profitLoss)} FC`;
            profitElement.className = `portfolio-value ${profitLoss >= 0 ? 'positive' : 'negative'}`;
            
            // Render owned coins table
            const portfolioTable = document.getElementById('portfolio-table-body');
            portfolioTable.innerHTML = '';
            
            ownedCoins.forEach((item, index) => {
                const row = document.createElement('tr');
                const plClass = item.profitLoss >= 0 ? 'positive' : 'negative';
                const plIcon = item.profitLoss >= 0 ? 'fa-arrow-up' : 'fa-arrow-down';
                
                row.innerHTML = `
                    <td>${index + 1}</td>
                    <td>
                        <div class="table-coin">
                            <img src="${item.coin.image}" alt="${item.coin.name}" class="table-coin-icon">
                            <div>
                                <div>${item.coin.name}</div>
                                <div class="coin-symbol">${item.coin.symbol}</div>
                            </div>
                        </div>
                    </td>
                    <td>${formatCurrency(item.amount)} ${item.coin.symbol}</td>
                    <td>${formatCurrency(item.value)} FC</td>
                    <td>${formatCurrency(item.avgBuyPrice)} FC</td>
                    <td class="${plClass}">
                        <i class="fas ${plIcon}"></i> ${formatCurrency(Math.abs(item.profitLoss))} FC (${Math.abs(item.profitLossPct).toFixed(2)}%)
                    </td>
                    <td>
                        <div class="table-actions">
                            <button class="action-btn buy-btn" data-coin="${item.coin.id}">Buy</button>
                            <button class="action-btn sell-btn" data-coin="${item.coin.id}">Sell</button>
                        </div>
                    </td>
                `;
                
                portfolioTable.appendChild(row);
            });
            
            // Add event listeners to buy/sell buttons
            document.querySelectorAll('#portfolio-table-body .buy-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    e.stopPropagation();
                    currentCoinView = btn.getAttribute('data-coin');
                    openTradeModal(currentCoinView, 'buy');
                });
            });
            
            document.querySelectorAll('#portfolio-table-body .sell-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    e.stopPropagation();
                    currentCoinView = btn.getAttribute('data-coin');
                    openTradeModal(currentCoinView, 'sell');
                });
            });
            
            // Render created coins table
            const createdCoinsTable = document.getElementById('created-coins-table-body');
            createdCoinsTable.innerHTML = '';
            
            const createdCoins = coins.filter(coin => coin.creator === currentUser.id);
            
            createdCoins.forEach((coin, index) => {
                const row = document.createElement('tr');
                const changeClass = coin.change24h >= 0 ? 'positive' : 'negative';
                const changeIcon = coin.change24h >= 0 ? 'fa-arrow-up' : 'fa-arrow-down';
                
                row.innerHTML = `
                    <td>${index + 1}</td>
                    <td>
                        <div class="table-coin">
                            <img src="${coin.image}" alt="${coin.name}" class="table-coin-icon">
                            <div>
                                <div>${coin.name}</div>
                                <div class="coin-symbol">${coin.symbol}</div>
                            </div>
                        </div>
                    </td>
                    <td>${formatCurrency(coin.currentPrice)} FC</td>
                    <td>${formatCurrency(coin.marketCap)} FC</td>
                    <td>${formatCurrency(coin.totalSupply)} ${coin.symbol}</td>
                    <td>
                        <div class="table-actions">
                            <button class="action-btn view-btn" data-coin="${coin.id}">View</button>
                        </div>
                    </td>
                `;
                
                createdCoinsTable.appendChild(row);
            });
            
            // Add event listeners to view buttons
            document.querySelectorAll('#created-coins-table-body .view-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    e.stopPropagation();
                    currentCoinView = btn.getAttribute('data-coin');
                    showPage('coin');
                });
            });
        }
        
        // Render profile page
        function renderProfilePage() {
            document.getElementById('profile-avatar').src = currentUser.picture;
            document.getElementById('profile-name').textContent = currentUser.displayName || currentUser.name;
            document.getElementById('profile-username').textContent = `@${currentUser.username}`;
            document.getElementById('profile-balance').textContent = `${formatCurrency(currentUser.balance)} FC`;
            
            // Calculate stats
            const userTransactions = transactions.filter(t => t.userId === currentUser.id);
            const tradeCount = userTransactions.filter(t => t.type === 'buy' || t.type === 'sell').length;
            const coinsOwned = Object.keys(currentUser.coins).length;
            const coinsCreated = coins.filter(c => c.creator === currentUser.id).length;
            
            document.getElementById('total-trades').textContent = tradeCount;
            document.getElementById('coins-owned').textContent = coinsOwned;
            document.getElementById('coins-created').textContent = coinsCreated;
            
            // Format join date
            const joinDate = new Date(currentUser.createdAt);
            document.getElementById('member-since').textContent = joinDate.toLocaleDateString('en-US', { 
                year: 'numeric', 
                month: 'short' 
            });
            
            // Render recent activity
            const activityTable = document.getElementById('activity-table-body');
            activityTable.innerHTML = '';
            
            const recentActivity = userTransactions.slice(0, 10).reverse();
            
            recentActivity.forEach(activity => {
                const row = document.createElement('tr');
                const date = new Date(activity.timestamp);
                
                let coinInfo = '';
                if (activity.coinId) {
                    const coin = coins.find(c => c.id === activity.coinId);
                    if (coin) {
                        coinInfo = `${coin.name} (${coin.symbol})`;
                    }
                }
                
                row.innerHTML = `
                    <td>${date.toLocaleDateString()}</td>
                    <td>${activity.type.replace('_', ' ').toUpperCase()}</td>
                    <td>${coinInfo}</td>
                    <td>${activity.amount || '-'}</td>
                    <td>${activity.price ? formatCurrency(activity.price) + ' FC' : '-'}</td>
                    <td>${activity.total ? formatCurrency(activity.total) + ' FC' : '-'}</td>
                `;
                
                activityTable.appendChild(row);
            });
        }
        
        // Render settings page
        function renderSettingsPage() {
            document.getElementById('display-name').value = currentUser.displayName || currentUser.name;
            document.getElementById('username').value = currentUser.username;
            document.getElementById('profile-pic').value = currentUser.picture;
        }
        
        // Save settings
        function saveSettings() {
            const displayName = document.getElementById('display-name').value;
            const username = document.getElementById('username').value;
            const picture = document.getElementById('profile-pic').value;
            
            if (!displayName || !username) {
                alert('Please fill in all required fields!');
                return;
            }
            
            // Check if username is available
            const users = JSON.parse(localStorage.getItem('freshcoinsUsers')) || [];
            if (users.some(u => u.username === username && u.id !== currentUser.id)) {
                alert('This username is already taken!');
                return;
            }
            
            currentUser.displayName = displayName;
            currentUser.username = username;
            currentUser.picture = picture;
            
            // Save user
            saveData();
            
            // Update UI
            updateUI();
            
            alert('Settings saved successfully!');
        }
        
        // Open trade modal
        function openTradeModal(coinId, type) {
            const coin = coins.find(c => c.id === coinId);
            if (!coin) return;
            
            tradeModalTitle.textContent = `${type === 'buy' ? 'Buy' : 'Sell'} ${coin.name} (${coin.symbol})`;
            tradePrice.value = coin.currentPrice.toFixed(2);
            tradeBalance.textContent = formatCurrency(type === 'buy' ? currentUser.balance : (currentUser.coins[coin.id] || 0));
            
            // Reset amount
            tradeAmount.value = '';
            tradeTotal.value = '0.00';
            
            // Update confirm button
            confirmTrade.textContent = type === 'buy' ? 'Buy' : 'Sell';
            confirmTrade.className = `action-btn ${type === 'buy' ? 'buy-btn' : 'sell-btn'}`;
            
            // Store trade type
            confirmTrade.setAttribute('data-type', type);
            
            tradeModal.classList.add('show');
        }
        
        // Update trade total when amount changes
        function updateTradeTotal() {
            const amount = parseFloat(tradeAmount.value) || 0;
            const price = parseFloat(tradePrice.value) || 0;
            const total = amount * price;
            
            tradeTotal.value = total.toFixed(2);
        }
        
        // Execute trade
        function executeTrade() {
            const type = confirmTrade.getAttribute('data-type');
            const coin = coins.find(c => c.id === currentCoinView);
            if (!coin) return;
            
            const amount = parseFloat(tradeAmount.value);
            const price = parseFloat(tradePrice.value);
            const total = amount * price;
            
            if (isNaN(amount) {
                alert('Please enter a valid amount!');
                return;
            }
            
            if (amount <= 0) {
                alert('Amount must be greater than zero!');
                return;
            }
            
            if (type === 'buy') {
                if (total > currentUser.balance) {
                    alert('You don\'t have enough FreshCoins for this purchase!');
                    return;
                }
                
                // Deduct balance
                currentUser.balance -= total;
                
                // Add to holdings
                if (!currentUser.coins[coin.id]) {
                    currentUser.coins[coin.id] = 0;
                }
                currentUser.coins[coin.id] += amount;
                
                // Update coin volume
                coin.volume24h += total;
            } else { // sell
                const holdings = currentUser.coins[coin.id] || 0;
                
                if (amount > holdings) {
                    alert(`You don't have enough ${coin.symbol} to sell!`);
                    return;
                }
                
                // Add to balance
                currentUser.balance += total;
                
                // Remove from holdings
                currentUser.coins[coin.id] -= amount;
                if (currentUser.coins[coin.id] <= 0) {
                    delete currentUser.coins[coin.id];
                }
                
                // Update coin volume
                coin.volume24h += total;
            }
            
            // Add transaction
            transactions.push({
                id: generateId(),
                userId: currentUser.id,
                type,
                coinId: coin.id,
                amount,
                price,
                total,
                timestamp: new Date().getTime()
            });
            
            // Simulate price change
            simulatePriceChange(coin, type, amount);
            
            // Save data
            saveData();
            
            // Close modal
            tradeModal.classList.remove('show');
            
            // Update UI
            updateUI();
            
            // Show success message
            alert(`Successfully ${type === 'buy' ? 'bought' : 'sold'} ${amount} ${coin.symbol} for ${formatCurrency(total)} FC!`);
        }
        
        // Simulate price change after trade
        function simulatePriceChange(coin, type, amount) {
            // Simple simulation - buying increases price, selling decreases
            const changeFactor = amount / coin.circulatingSupply;
            const changePercent = type === 'buy' ? 
                Math.min(changeFactor * 5, 0.05) : // Max 5% increase
                Math.max(-changeFactor * 5, -0.05); // Max 5% decrease
            
            const newPrice = coin.currentPrice * (1 + changePercent);
            const priceChange = newPrice - coin.currentPrice;
            
            // Update coin data
            coin.currentPrice = parseFloat(newPrice.toFixed(2));
            coin.marketCap = coin.currentPrice * (coin.circulatingSupply || coin.totalSupply);
            
            // Update 24h change
            coin.change24h = parseFloat((coin.change24h + changePercent * 100).toFixed(2));
            
            // Add to price history
            const now = new Date();
            priceHistory[coin.id].push({
                date: now.getTime(),
                price: coin.currentPrice
            });
            
            // Keep only last 30 days
            if (priceHistory[coin.id].length > 30) {
                priceHistory[coin.id].shift();
            }
        }
        
        // Update UI based on current state
        function updateUI() {
            if (!currentUser) return;
            
            // Update profile image
            document.getElementById('profile-img').src = currentUser.picture;
            
            // Update pages based on current view
            switch (currentView) {
                case 'home':
                    renderHomePage();
                    break;
                case 'market':
                    renderMarketPage();
                    break;
                case 'coin':
                    renderCoinDetailPage();
                    break;
                case 'portfolio':
                    renderPortfolioPage();
                    break;
                case 'profile':
                    renderProfilePage();
                    break;
                case 'settings':
                    renderSettingsPage();
                    break;
            }
        }
        
        // Logout user
        function logout() {
            currentUser = null;
            localStorage.removeItem('freshcoinsUser');
            showPage('auth');
        }
        
        // Format currency
        function formatCurrency(value) {
            if (isNaN(value)) return '0';
            return value.toLocaleString('en-US', {
                minimumFractionDigits: 2,
                maximumFractionDigits: 2
            });
        }
        
        // Generate random ID
        function generateId() {
            return Math.random().toString(36).substr(2, 9);
        }
        
        // Generate username from name
        function generateUsername(name) {
            const base = name.toLowerCase().replace(/\s+/g, '');
            return `${base}${Math.floor(Math.random() * 1000)}`;
        }
        
        // Initialize the app when DOM is loaded
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
